!function(n,e){function t(n){if(n instanceof Array)return{path:n,str:n.join(".")};if("string"==typeof n)return{path:n.split("."),str:n}}function s(n,e){if(0!==e.length&&void 0!==n){var s=t(e);if(s){e=s.path;for(var i=0;i<e.length;i++)if(n=n[e[i]],void 0===n)return;return n}}}function i(n,e,t){return Object.defineProperty(n,e,{enumerable:!1,value:t}),n}n&&(e=module.exports);var r=n?process.nextTick:e.requestAnimationFrame,a=0,d={jobs:{},_signed:{},scheduled:!1,__digest:function(){var n=this;n.scheduled===!1&&(n.scheduled=!0,r(function(){for(var e in n.jobs)n.jobs[e](),delete n.jobs[e];for(var e in n._signed){var t=n._signed[e];t.signed.apply(null,t.target()),delete n._signed[e]}n.scheduled=!1}))},sign:function(n,e){return n.$id||(n.$id=a++),n.$instant?n.apply(null,e()):(this._signed[n.$id]={target:e,signed:n},this.__digest())},add:function(n,e,t){return e=t?e.bind(t):e,this.jobs[n]=e,this.__digest()}},c=0,o=function(n,e,r,f){if("object"==typeof n&&"function"==typeof r){var u=t(e);if(u){r.$id?r.$id:a++,f&&(r.$instant=!0);for(var l=u.path,$=u.str,p=l[0],h=[],g=0;g<l.length;g++)h.push(l[g]);var v,b=h.splice(1,h.length),y=b.join("."),_=p===$,j=n.$$p;j||(i(n,"$$p",{}),j=n.$$p,i(j,"$properties",{}),i(j,"$id",++c)),void 0===v&&(v=j.$id);var k=j.$properties[p];if(!k){k=j.$properties[p]={$self:[],$descendants:{}};var m=n[p];Object.defineProperty(n,p,{get:function(){return m},set:function(n){return A(n,m),m=n}});var A=function(n,e){for(var t in k.$descendants)if(k.$descendants.hasOwnProperty(t)){for(var i in k.$descendants[t].callbacks){var r=k.$descendants[t].callbacks[i];d.sign(r,function(){return[s(n,t),e]})}d.add(v+t,function(){k.$descendants[this.key].bindWatcher()},{key:t})}if(_)for(var i=0;i<k.$self.length;i++){var a=k.$self[i];d.sign(a,function(){return[n,e]})}}}_?(d.sign(r,function(){return[n[p]]}),k.$self.push(r)):(k.$descendants[y]?k.$descendants[y].callbacks.push(r):(k.$descendants[y]={callbacks:[r],bindWatcher:function(){n.hasOwnProperty(p)&&void 0!==n[p]&&o(n[p],b,function(n,e){for(var t=0;t<k.$descendants[y].callbacks.length;t++){var s=k.$descendants[y].callbacks[t];d.sign(s,function(){return[n,e]})}},!0)}},k.$descendants[y].bindWatcher()),d.sign(r,function(){return[s(n[p],b)]}))}}};e.AsyncWatch=o,e.AsyncTransaction=d}("undefined"!=typeof module&&module.exports,this);